define("unilabeltype_imageboard/imageboardpreviewrenderer",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=()=>{function focusoutExecute(event){var number=function(event){let imageidselectors=["id_unilabeltype_imageboard_title_","id_unilabeltype_imageboard_xposition_","id_unilabeltype_imageboard_yposition_","id_unilabeltype_imageboard_targetwidth_","id_unilabeltype_imageboard_targetheight_","id_unilabeltype_imageboard_border_"];const eventid=event.target.getAttribute("id");for(let i=0;i<imageidselectors.length;i++)if(eventid.includes(imageidselectors[i]))return eventid.split(imageidselectors[i])[1];return-1}(event);number>=0&&refreshImage(number)}function onclickExecute(event){event.target.getAttribute("id").split("button-mform1")[1]&&setTimeout((function(){addImageToDom(document.querySelectorAll('[id^="fitem_id_unilabeltype_imageboard_title_"]').length-1)}),500)}function refreshBackgroundImage(){let previewimage=document.getElementById("id_unilabeltype_imageboard_backgroundimage_fieldset").getElementsByClassName("realpreview"),backgrounddiv=document.getElementById("unilabel-imageboard-background-area");if(previewimage.length>0){let backgroundurl=previewimage[0].getAttribute("src").split("?")[0];previewimage[0].getAttribute("src").split("?")[1].includes("&oid=")&&(backgroundurl+="?oid="+previewimage[0].getAttribute("src").split("&oid=")[1]),backgrounddiv.style.background="red",backgrounddiv.style.backgroundSize="cover",backgrounddiv.style.backgroundImage="url('"+backgroundurl+"')";let canvaswidth=document.getElementById("id_unilabeltype_imageboard_canvaswidth").selectedOptions[0].value;backgrounddiv.style.width=canvaswidth+"px";let canvasheight=document.getElementById("id_unilabeltype_imageboard_canvasheight").selectedOptions[0].value;backgrounddiv.style.height=canvasheight+"px"}else{backgrounddiv.style.background="green",backgrounddiv.style.backgroundImage="url('')";let canvaswidth=document.getElementById("id_unilabeltype_imageboard_canvaswidth").selectedOptions[0].value;backgrounddiv.style.width=canvaswidth+"px";let canvasheight=document.getElementById("id_unilabeltype_imageboard_canvasheight").selectedOptions[0].value;backgrounddiv.style.height=canvasheight+"px"}}function refreshAllImages(){const singleElements=document.querySelectorAll('[id^="fitem_id_unilabeltype_imageboard_image_"]');for(let i=0;i<singleElements.length;i++){let number=singleElements[i].getAttribute("id").split("fitem_id_unilabeltype_imageboard_image_")[1];null===document.getElementById("unilabel-imageboard-imageid_"+number)?(addImageToDom(number),refreshImage(number)):refreshImage(number)}}function addImageToDom(number){let backgroundArea=document.getElementById("unilabel-imageboard-background-area");if(null===document.getElementById("unilabel-imageboard-imageid_"+number)){backgroundArea.innerHTML=backgroundArea.innerHTML+function(number){return"<div id='unilabel_imageboard_imagediv_"+number+"' style='z-index: 5; position: absolute;'><div id='imageidtitle_"+number+"' class='unilabel-imageboard-title rounded'  style='position: relative;'>Ãœberschrift</div><div id='imageidimage_"+number+"'><img draggable='true' class='image' src='' id='unilabel-imageboard-imageid_"+number+"' style='position: relative; background-color: #f00;'></div></div>"}(number);let imagefileNode=document.getElementById("fitem_id_unilabeltype_imageboard_image_"+number);if(imagefileNode){new MutationObserver(refreshImage).observe(imagefileNode,{attributes:!0,childList:!0,subtree:!0})}refreshImage(number)}else refreshImage(number)}function refreshImage(number){if(Array.isArray(number))setTimeout((function(){refreshAllImages()}),600);else{let imageid=document.getElementById("unilabel-imageboard-imageid_"+number),imagedata=function(number){let imageids={title:"id_unilabeltype_imageboard_title_"+number,xposition:"id_unilabeltype_imageboard_xposition_"+number,yposition:"id_unilabeltype_imageboard_yposition_"+number,targetwidth:"id_unilabeltype_imageboard_targetwidth_"+number,targetheight:"id_unilabeltype_imageboard_targetheight_"+number,src:"",border:"id_unilabeltype_imageboard_border_"+number},imagedata=[];imagedata.title=document.getElementById(imageids.title).value,imagedata.xposition=document.getElementById(imageids.xposition).value,imagedata.yposition=document.getElementById(imageids.yposition).value,imagedata.targetwidth=document.getElementById(imageids.targetwidth).value,imagedata.targetheight=document.getElementById(imageids.targetheight).value;const imagetag=document.getElementById("id_unilabeltype_imageboard_image_"+number+"_fieldset").getElementsByTagName("img");let src="";imagetag.length&&0!=imagetag.length&&(src=imagetag[0].src,src=src.split("?")[0]);return imagedata.src=src,imagedata.border=document.getElementById(imageids.border).value,imagedata}(number);imageid.style.background="blue",imageid.src=imagedata.src;const imagediv=document.getElementById("unilabel_imageboard_imagediv_"+number);imagediv.style.left=parseInt(imagedata.xposition)+"px",imagediv.style.top=parseInt(imagedata.yposition)+"px",0!=imagedata.targetwidth?imageid.style.width=imagedata.targetwidth+"px":imageid.style.width="auto",0!=imagedata.targetheight?imageid.style.height=imagedata.targetheight+"px":imageid.style.height="auto",""!=imagedata.title?imageid.title=imagedata.title:imageid.title="";let colourpicker=document.getElementById("id_unilabeltype_imageboard_titlebackgroundcolor_colourpicker"),color="";color=""==colourpicker.value?"#000000":colourpicker.value,0!=imagedata.border?(imageid.style.border=imagedata.border+"px solid",imageid.style.borderColor=color):imageid.style.border="0";let title=imagedata.title;document.getElementById("imageidtitle_"+number).innerHTML=title}}!function(){var mform=document.querySelectorAll('[id^="mform"]')[0];mform.addEventListener("focusout",focusoutExecute,!1),mform.addEventListener("click",onclickExecute,!1);let backgroundfileNode=document.getElementById("id_unilabeltype_imageboard_backgroundimage_fieldset");if(backgroundfileNode){new MutationObserver(refreshBackgroundImage).observe(backgroundfileNode,{attributes:!0,childList:!0,subtree:!0})}let canvasx=document.getElementById("id_unilabeltype_imageboard_canvaswidth");if(canvasx){new MutationObserver(refreshBackgroundImage).observe(canvasx,{attributes:!0,childList:!0,subtree:!0})}let canvasy=document.getElementById("id_unilabeltype_imageboard_canvasheight");if(canvasy){new MutationObserver(refreshBackgroundImage).observe(canvasy,{attributes:!0,childList:!0,subtree:!0})}}(),setTimeout(refreshBackgroundImage,1e3),setTimeout(refreshAllImages,1e3),setTimeout((function(){}),500)}}));

//# sourceMappingURL=imageboardpreviewrenderer.min.js.map